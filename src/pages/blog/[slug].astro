---
import fetchApi from '../../../lib/strapi';
import MarkdownComponent from '../../components/MarkdownComponent.astro';
import type Article from '../../interfaces/article';
import BlogLayout from '../../layouts/BlogLayout.astro';

const { slug } = Astro.params;

let article: Article;

try {
  article = await fetchApi<Article>({
    endpoint: 'articles?populate=heroImage',
    wrappedByKey: 'data',
    wrappedByList: true,
    query: {
      'filters[slug][$eq]': slug || '',
    },
  });
} catch (error) {
  return Astro.redirect('/404');
}

---
<BlogLayout {...article.attributes}>
	<MarkdownComponent data={article.attributes.content}/>
</BlogLayout>
