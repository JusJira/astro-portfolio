---
export const prerender = false;

import { SITE_TITLE, SITE_DESCRIPTION } from "../../consts";
import Layout from "../../layouts/Layout.astro";
import fetchApi from "../../../lib/strapi";
import type Article from "../../interfaces/article";
import { Image } from "astro:assets";

const articles = await fetchApi<Article[]>({
  endpoint: "articles?populate=heroImage",
  wrappedByKey: "data",
});
const catFetch = await fetch('https://api.thecatapi.com/v1/images/search')
const catData = await catFetch.json()
import "@fontsource-variable/open-sans";
---

<Layout title={`${SITE_TITLE} - Projects`} description={SITE_DESCRIPTION}>
  <div class="p-2 max-w-[calc(100%_-_2em)] w-[1024px] m-auto pt-10">
    <h1 class="dark:text-white font-bold text-xl text-center mb-10">
      Here are my blogs, enjoy!
    </h1>
    <div class="grid gap-3 grid-cols-[repeat(auto-fit,minmax(200px,1fr))]">
      {
        articles.length == 0 ? (
          <div class="m-auto dark:text-white flex flex-col items-center justify-center">
            <p class="text-center">Nothing for now, So here is a picture of a cat instead!</p>
            <img src={catData[0].url}>
          </div>
        ) : null
      }
      {
        articles.map((article) => (
          <a
            href={`/blog/${article.attributes.slug}/`}
            class="dark:text-white bg-stone-900 aspect-video relative rounded-lg"
          >
            <Image
              src={
                import.meta.env.STRAPI_URL +
                article.attributes.heroImage.data.attributes.formats.small.url
              }
              class="aspect-video rounded-lg"
              width={1600}
              height={900}
              alt="Blog post hero image"
            />
            <div class="absolute w-full h-full top-0 backdrop-brightness-75 hover:backdrop-brightness-100 transition-all duration-100 flex flex-col justify-end p-4 rounded-lg">
              <h2 class="font-semibold text-lg text-white" id="title">
                {article.attributes.title}
              </h2>
              <p class="line-clamp-2 text-sm font-thin text-white">
                {article.attributes.description}
              </p>
            </div>
          </a>
        ))
      }
    </div>
  </div>
</Layout>
<style>
  #title {
    font-family: "Open Sans Variable", sans-serif;
  }
</style>
